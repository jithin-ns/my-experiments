Perfect ğŸ‘Œ Letâ€™s do this properly using PnPjs, which is the cleanest way inside SPFx.

Assume:

List name: Test Users

You are inside an SPFx React web part

You already installed PnP packages



---

ğŸ”¹ 1ï¸âƒ£ Install PnP (If Not Installed)

npm install @pnp/sp @pnp/spfx --save


---

ğŸ”¹ 2ï¸âƒ£ Configure PnP in Your Web Part (Important)

Inside your main web part file:

// YourWebPart.ts

import { spfi, SPFx } from "@pnp/sp";
import "@pnp/sp/lists";
import "@pnp/sp/items";

private _sp;

protected onInit(): Promise<void> {
  return super.onInit().then(() => {
    this._sp = spfi().using(SPFx(this.context));
  });
}

Now _sp is connected to your current site.


---

ğŸ”¹ 3ï¸âƒ£ Pass SP Instance to React Component

Inside render():

this.domElement.innerHTML = "";
const element = React.createElement(App, {
  sp: this._sp
});
ReactDom.render(element, this.domElement);


---

ğŸ”¹ 4ï¸âƒ£ React Component â€“ Fetch List Items

Example: Get All Items from â€œTest Usersâ€

// App.tsx

import * as React from "react";
import { useEffect, useState } from "react";
import { SPFI } from "@pnp/sp";

interface IProps {
  sp: SPFI;
}

interface ITestUser {
  Id: number;
  Title: string;
}

const App: React.FC<IProps> = ({ sp }) => {
  const [users, setUsers] = useState<ITestUser[]>([]);

  useEffect(() => {
    const fetchData = async () => {
      const items = await sp.web.lists
        .getByTitle("Test Users")
        .items
        .select("Id", "Title")();

      setUsers(items);
    };

    fetchData();
  }, []);

  return (
    <div>
      <h2>Test Users List</h2>
      <ul>
        {users.map(user => (
          <li key={user.Id}>{user.Title}</li>
        ))}
      </ul>
    </div>
  );
};

export default App;


---

ğŸ”¹ What This Does

Connects to current SharePoint site

Reads list named Test Users

Fetches Id + Title column

Displays them in a list



---

ğŸ”¹ If Your List Has Custom Columns

Example columns:

Name

Email

Department (Lookup)


Update select:

.select("Id", "Title", "Email", "Department/Title")
.expand("Department")


---

ğŸ”¥ Important Notes

1ï¸âƒ£ List name must match exactly
2ï¸âƒ£ Internal column names matter
3ï¸âƒ£ User must have read permission
4ï¸âƒ£ This works only in Hosted Workbench (not local standalone)


---

ğŸ” If You Donâ€™t Want PnP (Using SPHttpClient)

Let me know â€” Iâ€™ll give that version too.

But PnP is strongly recommended for enterprise SPFx.


---

If you paste your list column structure, I can tailor the exact query for your schema.
